const _ = require('lodash');
const input = `.v>....v.vv....v..>v..v>.vv>>>>>v>.v..>>v.vvv.>>..>.>v..v.>>....v...>>v...>..>.>>v..v...v.v.v.>>>.v>.vv>v>v..v>>>.>...>v.>.>>.v..v.vv.vv>..
>.>.>..>..v>...v.>.>..v..v.......>>>v...>>>v.>v..>...>v.v>.>..>.>>.....>>vv.....>.>v>.v.........>v..>v..>v..v>.....v...>>..v.v.>.v...>v.>..
.>.v..>...v..>>.v..v.v>vv>.v...v.>>.>v..v...v.v..v.>.v.>v.>>v>.v>.>v.>.>.v..>>v>.>>v...>...>...vv.v.>v.>.v.v..vv>.v.v..v..v.v>vv>.v.>..>>>.
..v...>.vv>.v..>>>.>....v.>.>...>v.>vv.v>>>..v..>......>.>..v.>.>v...>.v....>>.v..v.v.v.v.v.>>v>v.>>.v>...>v.>v.....v.v....v>...>v.v.v.>v>v
>v>vv.>>..vv.vv....>.>..>.vv..>>v.>>..>..v>.v..v.>..vvvvvv>>.v.>v.v..v.>.v>.v.>>...vv.>v>vv.>>>>>v....>>>>.v.v.>v.>.....>.>.v>...vvv>v>.>..
...vv.v>.>>>>>>..v>..>>v.vvv...v.>..v>v..>v>.>v..>.v.v..>..v.>.>.v.>.>.vvv.v>.>v...>.>..>>.v>...>.v..>v>.>.>.vvv>..vvv.v.>vv.v.>.v..>..v.v.
>vv>...v.>..>..>.>>.v>v.>vv..>v>..>..>>..>.....>.v.>vvv>..>......>..v.>>....v>.>..>.vv.>>>.>v>.>>>>..v.>vv..vv>.v.>>v..v>v.>v..>....v..v..v
>.>....v....v..v...v>>.v>.>>>..>..v.>v>...>>.v>vvv..vv.v.v.>.>.v>>..v...v.v>.>..>..>.vv>>..>v....v>v>.v..v.>.v.v>v..>.>v>v.>v>>>.>v..v>>vv.
.>..v.vvv>...>>.>>>....v>.v>>>..v.>.>>..>>>v>>..v..>v>.>>....v>v>>.>.>v....>v.v>>..>....v.>v.v>v.>>vv>>>.vv.>>v..v.v>>.vvvv>..>v>v.>vv..>>.
v>.v.>vv...vv.v>.v..>>.>v.>v>..vv.v.v..v.v>>......v>>..v.....vvv...vv.v..vvv.>.vv>v>..>v>.....>...vv.v>.vv.>>.>.v.vvv>..v>.v.vvvv.v>....v.>
v.v...v..>..>..>.v..vv>>..v..>>>v..vv..vv>..v.>>...>>..>v..v.>.>>.v>......>v....v.vvv...v..v>..v>>.v>..vvv>v.v>..v>v.>>>....vv..v.>v>>....v
v>..>..>..vv.v>>v.v>v..v...>...v>.v.v>v..v..>.>.>vv.>>..vvv.vv>...vv..>.>>..vv.v>v>v...v>..>v.....>...>..........>...v..v..v.>>.>.v..>.vv>.
..v....v...v>..>..vvv.v>.>.v...>..v.v......>..>...v.>>>.vv..>>vvv.vv.>v.v.>.>..vv>.....v>v>.>>.>.>.vv>.v.>v>v.v>..>v.>v....vv.vv...vv..>..>
>v.>>vv>.vv...>.>v.v......>..>.v>...v>>v..>>..>....>...v...>v.vv..>vvv.....v>.v.v>..>>.vv..>.>..vv.v>vv>>v.>...>>>.>v>......v.>.>..>.>..vv.
.v...v.>.vvvvv......v.>.v.>vvv.>>>>>.vvv>..v...>.v>>...v......vv>..>>>v...>>v...>v...........>.v.>...>v.v.v.v..>>v.vvv>....v>.>>.v.>.>...>.
..>..>.>>.v.vv..>>v..v...>v.>.v>..>.>v.v.....>.v.......v..>>...>.....v...vv>>v..>>....vv>>..vv..>>>.>>..>.>.>>..v>.vvv>>....>..v>vv.v>>..v.
....v.....v.>vv.>>>.>..v..>..v>...v...v..vv>>v.v..>>v...v.>.v.v..v.vv..>.>>v..>.>.vv>.>......>..........>v.v.>v.vv>.v.vvvv>..>.>>....>>>v.>
.v.>......v>vv.>v..v>vv.vvv>.>>.vv.v>.>v.vvvvvv.vv.v.>.....>..v....>..v.>...>>....>.>.>.......>v.>v..v>v>>...>.>.....v..v..>vvvv...>...v>>.
v.....v.v.vv.>>>v>v>v>.v..>..v.>v...>>.>...>....v..>>v....v>>>.vv>>>.v.>.....>.>.>...v>>.>.v..v>>.>>.v>>..v..v>v.v>v>>..v..v.v>>>.>v....>.>
..>.vvvv>>v.>v....>vv..>v>....vv.......v.>v>v.v.vv.>.>..>...>>v...v...v>>v.v.v.>.>>..v>..vv....>..>vvvv.v..v.v>>.v>v.>.v...v.>v..>.v.....vv
.v.v..v>>..v....v.v.>.v.v....>>>.v.....v.>...v>.v..v.....>>...v.v>.v.....vv>>....v...v>.........>vv..vv>>..v.>>vvv.....>..>v.....>..>..v>..
..v....vv>v..v..vvv.>.>.>v..v.vv>.v.v>...v>>.v.v.v>...vv..v>v.....v..v.v.>....>>...>v.>v.>.>>vvvv...........>vv..>..>..>>..v>...v>>.v.v.>.>
..v>..v>.>.....>.>....vv...vv...>.....>>.>>.>..>>.>>.>.>vv...>>>v.>>..v>>....v.v.>>..v.>v.....>>.vv.v....>>>...>.>....v..>.vv.>v>.v.....vvv
v>>.>.vv.....>>vvvv..vv..v..v>.>....vv.>v.vv>..>>vv>...v.>>...>..v.>v.>.vv>>vvvv.>..>.v>.v.>....>>...>.>>v..>v.>>vv.>.>>>.>..>..>v..v.vvvv.
>>vv.v>>>.>>..v>>>..vv.v>>.>.....v>vvv.v...v.v>..v.>.>>...v...>.>v>vv..>>>.>v>v....>..v>>..>v...>..>>>...vv.>>>...>...>....>v.>>..>>.vv.v..
..>vv..v..v.v..>...>>v.v>>v..>>>v>..v>....>>>..vv>.>>.v..vv..v>.v>.>>>.>>.v>v..v>v>>.v..>...v>>>...vvv>.v...>......>v>.vvv.vv..>>...vv>vv..
.v..>v...>....v......>>..v>v..v.v..>>....>vv>v..>>>....v>....v>.v>>..v>.v.v....>.>..v...>.>.>.>v..>....vv>v>>v...>.>.v...vv....vv>>>....vv.
..v..>.>...v>..v.v>>>.>v>v.vv..>>>>>>..>vv>v.v.>>....v>vvv..>.v>v>.>>.v..>vv>>......vv>vv>>v.>.v...>.v..>.>.>.>v.v.v.v>..>....>.v.v....>>vv
vv..>v..>.vvv>>.>.v.vv>..>v.v.v..>.>.vv>>..v..>v>v.>..v>>v.>.vv.>>v..vv.>.>...v..>v>>vvvv>v.v.v..v.>v..>..v>>....>..>v>....v.>..>....>..v>.
>.v.>>>>v>.v>v..>v.v>.v.>>......>.v.>>>v..>v...v...v.vv..v.>>..v...v.>.v>v>v.vv>>>..>v>.........vv..vv>......>....>>>..v>v.>v>>..v.>>..v>>.
v.v>..>v.v..>>...>.vv>v..>>.v...>..>v>.v.v.v.v.>.v.v...vv...>>.>.>.>.vv...>>.>vv...v>.>>...v...>.>>..v.v..>v..v.>v.vv.v....>>v......v.>vv..
...>.>..v......v>>v>.v....vv.......>..vv...v.vvvvvv>...v.>..v..v.v..>.....>v.>..>.>v>..v...>v.>>>v.v.vv...>>v>v.vv..>v>.....vv.>.>.>.>.>.vv
....v.v.v>..vv....>...>>vvv..v>vv>.>.vvvvv>v>v.v>...>..>..v.v.>v..>...v..vv>>v>v>.vv.>...v.>>vv...vv>>.>...v.v.v.>>.........>vv..>>..>>v>.v
..>>.v.>.v.>>.>..v>>>..>..v...v.v..>.vv.v>.>>>v.>.v.......v...v..v...vv.>......v....>.>...vv..>>vv.v.v...>>>..>>>.>..v>>.v...v.>vvvvvv...v.
.>vv>.v>.vv..>.>..>>vvv.vv..>>v.v>>..>v....>vv>>>vv..>v.v>..>.....v>>v.......v.>...>>.>....>.>v..v......>.>v..vv....>.vv>..v>v>>>.>.>.vv...
...>>vvv>>>.......v.v>v>>..>>vv.>..vv..vv..>>v....>vv.>...v>>v..>vv....>....v>..vvv....>.>.>......>>..>.>v>v.>..>v>>>......>>.vvvv.v....>v.
>...v>....>.>v..>....>>..vvv.......>>>>...>v.>>>...>.......v..>...vvvv>vv...v.v.v>>...>>>>.>.>>>.>>>......vv>>..v.>v.vvvvv......v.>v...vv..
v....>v.>>.>..v>.v..v.vv...v.>..>>>.......>>.v....v>.vv.>v..v.>....vvv>.>.......>...vvv>.v>v>>..>..v.>.>...>>.....>.vvv.>.>v>.v.v..v.vvv.v.
...>>v>.vv.v.vvv.>>..>..v...v>v..>....v.v.>v..>.....>>.v..>>>>v>>.......>v>..v>>.v.>.v>v...v>..vvvv...>>v.>>...v.v>.v>v.v>>.>>>>v>>.v>>>.v>
.>>......>v>.>...>..>.vvvv>>...v.v>>.>..>.>...v.....>>...v..v.>.>vv>..>v>..vv>..>>>v..>..v...>..>vv....vvvv.v>..>.>>v>..v..>>......v.>.v.v.
.>>.v.vvv.v..>>v..v..v......vv>.....vv>..vvv>.v..vvv>>.vv.v>.>.vv.v.v..>..>..v>..v>..v>>......>>.>.v.>>>v>vv..>>.>>...vv>v.>.v..>>.v....>.v
v>v...v...>..v...>v>>.v...vvv.v>.>vvv>>>>.....v.v>..v>vv.>v....>.vv...v>v>...>v.v.>...vv>..v>...v>.v.>>vv>..>>...>..>.....v...v.v.v>>vv.>>.
>v....>.....v...>..vv>.v...v>v>..>..v..>..v..>>>...v>vv>v..>..v.v>v>...>>...v..v>>v..v..>.>...v>>vv.v..>.v.v>.v>.v.>.>...v.>..vv>...vvv....
v>.v>.>v>>>>>v>v>>v..>>vv>.>.>>.>.>.v.v.>v.>v>>v.v....>vv..>..v.v.v>>.v.vv.vvvvv>>vv.>...>..vvvv.>...>..>>>>>.>..>>v.>vvv>.vv..v>v>vv.vv>..
.....>v.>.v.v.>v....vvv.vv....vv.v>..v>vv>>....>>.>>...>>....>..vvv>>..v...>.v..v..>>>..>>..v.>>.>.>.>.v.v>>.>>..vv>v..>>>>vv.>...>...>.>>.
.>..>v..v.vv.>.>>>v...>>...v>.>.v..>....>...>.vvv...>v>...>.......>>.>vvvvv.vv.>.>.vvv.>.vvv.>.v..>.v>v.>vv.vv>.>>.v.v....v>.>.v>>..>...vv.
>v...>v.>..v..>>.v.>.v>v>v.v..v...v>.v>.>.>..>v>>v........v..vv>vv.v.>.v.vv.v..v>.v.v..v>........>v....v....v.v>..>>v>>.>..>.v...>vv>..>v.v
.vv>..>.vv.vvv.>.vvv..vv.>..v.>..>vv....>>v..v.>..v>>>..vv.v.>..>>v.v.>.....v..v..v.v...>>.....vv.vv.>..>.>v>vv>.>..>.v.v..>.v..vv.v..v.>>.
.>v..>>...vv>v...v..vv>>v.>.vv...>v.v>.v>.vvv>.>>.>..>>>.....>..>..>......>v.>..>..v..v....v.>.v>v.v...>.v.vvvvv.v>>>...>.v..vvv>>...vvv.v>
v.>>..v>.v.v.>>>.v>>>>>v..>....>.v.v>....v.>.>.>.v..>..>.....v....v.>v....>.>.v....vv>..>..vv..>..v.v.v>v..>.v>.....>v>vv..>>....>v...v>.>.
>......>>......>.v>..v>v.v.>.v...>.>.>....v.vvvv>v>>>v..vv>vv.>..v>....v........>>>v.v>>...>.vv>>..v>....v>>..>v....>v...>>>.>.........>..>
.>.vv....v.v.v.vv.>vvv.>vv......v>v.>.....vvv>.....>v.>v>.v....>..>.>v.>..>..>v.>...v.v..>>.v....>.v.>v>>>v.v...>.>.vv.>.v>>...v>>v>vv.>vv.
.vv...>.>>.>..v..>.>>..v..vv..vvvv......>>v.v.v>...v>v.....>vv>.v.....>>..>.v>.>....v.>.>.>>>...v>v.>..v..v...vv>>......>.>vvv>v.>vv.......
>.v.>v..>.v.....v..>.>..>>...>v>>>...>..>vv>>>.v>vv.>vvvv.>.v>v.>v.>.>...v..v>v..v..v..>>..v..v>vvvvv.....>vv.v>..vv.>vv..vvv...>>v..v>>.>.
..>v.>.>v>.>..>....vv..v>.>vvv.v>...>.>.v>.>>>v.>.>v>v.......v>..v>.>>>..v..vvv>...>v.>.>>..>vv>vv>vv.>.v..vv>.v>vv>>vvv...v>>...v.>..>v>.>
..>..v...>>vv>..>.>...vv..........v..v...>...>.>vv.vv.vv..v>.v>.vvv.v.>>v..vvvvv>...>.v>.>vvv>>...v.>>.v...>....>v..v>v>.>>..v...>.....>..v
....v.vv.v.>.>.>.v.vvv.>.>.>.....vv...>..>..v>.v..>>.>.v>.v>......vv>.v>>.v.>.v.v.>...>>.....>>vvv.vvv.....>.v..>...>>v>.v>>v..vv.v...v..>.
..>..>....v.>..v.....>.>.>>.>..>.v..>vv>..v>>.>vv.v.>.vv.>..>v.v....>v>>v.v.v.v...>..v.>.v>v.v.v..v>.v>v...>.v...>>.>..vvv..v>>>>v...>vv>..
...>v.>...vvv>..v>.vvvv.vv.>>...v>.v.>>.v>v...v...>>vvvv.v....v..v.....vv.....>.>>>...>v>v.>vv>>.v..>.v.>..>.....>.>..>...>....v..v.>.v>.v>
vv.v>>v.>..v>>>..>.>....v.v...v.>...>..v....>>..vv..v>......>>v>v.v>>.v.v>....>v.>..>..v>..>v.>.v.>vv.v.>>.>.v>>vvvvv...vv>v.vv..>......v..
...>.....>v...v>v.>..v........v>vv>>.>.vv.>v....v>v>>>.v...>.v...>>>>>vv>.vv>.v..>.v.vv.>.>>v....>>..>>>..v>v>>>>....>vv..>..>>v>.v.v>....>
.vv..>..v.vv.>.>>..>.vvv>.>vv>..>.....>>.>>..v.>..>..>....v>v>>.v>>..>>.>....>.>...>v.>.>.>>.v...v.v.v>v>>>>..v.v.v..>.>>......v...v>>.>>..
.>v...>v>vvv.>.vv..>>>v..v.v..v.>.>v...>v.>>.v>v...v>v>...>.>>v>v>..vvv.v.vv.vv.>>..v.>>......>..>v..>..>v>>v.v.>>.>.......v>.>.>>>v>>.>>v.
..v......>>>v.>..>.v>..v>>....>>>.>v....>..vv>.>v.>.v...v>>..v......v>>.>..v>.>>>.>vv>.....>>..vv.>v...v.....>..v>>>>...>.v..>....>..v>>...
....>..>..vv>.>.>.>>....>>>>v.>v>..v..v.vvv..>..>...>..>>.>v.......>..v.v>>.>.>v>>.>.v.v>>>..v..v>>...>...v>v>..>.vv>>.v>.>v...>>v>.....>vv
..v...vv...v>v>.v....v..>>>.>v...>v>...>>.>...v>..v>.v.>>>v..>vvv....>...v..v..>....v...>.v>v...>>.>...>.>vvv...v.>>.v.v......v>..>>.vv.>>v
v...vv..>..>v..vvvv........v.>.>..v.....>.>....vvvv.v>v>v>>v..>v>v.v>.>.>v>....vv>...>.>.v>>....>>v.v...>..>>>vv..v.vvv>.v.>v>v..v>.v>....v
.v.v>>>v.v...v.>v.>>v..>.>vv..>v........v.v...v>>.v.vv>v.>v.>v.>.>.>.v.>>...>vv.vv...v.v.>v.>....v.v>..vvv..>.......>.>vv>..v>..>.vv.....v.
>>.v.v>>v>..v...>.v>..v>.>.>..v.v..v>.v...vv..vv.vv>..v.vv.>v>>v>....>.vv.vv.vv....v.v...v>>v..>.v..vv.>>>>>.>v>v.>>......>v....v>v..vvv.v.
>..v.....vv>v..>......v..v...v..v>.>.>v.v>....v.>....v>>>.>v>.v.>..vv..>......vv..>.vvv...v...v..>.>...>v..vv..v>..>.>.vv...>v>...>...>.>>.
>..v>.>v..v..vvv.>>....v....vv.v.vvv.vv>>>v.........>>.>...v>.v>vvv..v.>>.>.v.>v>.vv..>..>>.v.>>>...v....>..v>..>.>.vv....vvv>......>..>.vv
>v..v>.>...v...>>.vv..v..>..>.>vv>>>>vv>>.v.v..>v>vv>...>v>vv...v>vv.v>v>>>..>...v>>>.>.>..v..v>>vv.>>vv..vv.....>v.>..v....>...>.v.....>>v
>>vv.........v>>..vv.v.....>v.v..v...>.vv...v..v>.v...v.v.v..vv.vv....>.v>vv>vv..>vv.v.v>v>>.>.v.....vv.v>..v>v..v..v..>..>>v....>v.>v..>..
.vv........>v...>..vvv.>v..vv>.v>..vv>vv>vvvvvv....vvv.>.v..>>......v..>>v>v.v>.>.>..v>.>...>vv...>>..v.vv>.v.>>v.>v..>.....v...>.v.>..>..v
>.vvv.>>.>....>.vvv>>v..>v>.>vv.>>.>>vv>vvv.>.v>>v>.>>>..v.vv.>>>.>.....>..>vv>>>.v.v...v>>v.v.v>.>.>>v>>.>vv..v.>v..>v..v..>>..>.>.vvv..v.
>>..>>.>v.>v..>..>vvv>v...vv>..>v.....v>v.>v.v.v>..>......>.v>.vv...v.....v.......>...>.v>v>vv.vvv>....v.>..v..>vv.>>>....>....>...>>.>v>vv
.>.vv...vvv.vv>vv...vvvvvv>..v..v...v..>v...>.>.>.v..v..>v>v....v>.vvv>.v.>vv..v.>....v>.v>>>.vv>.vv>....>..v..>v.v.>>v..>v...>v.v>>.>.>v..
.>>v..vvv.>..v>...>v>vv...>>..v.v.>>v>..>.>vv...>...>.>..v..v.....v....v..v>>vv>>.vv...v>>>...>>.v....>>....>>>.>>>>.v>...>.>>..>..>v...v>v
...>>v..>...>vv.>v>v>vvv.>.v.v>..>vv.v>...vv.>..>.....v>..v>..v>vv.>>>..>>v.v.v.......v.>..v..>.>v>>....>.>v...>.v>.>..>v..>.>...v>v...v.v.
.....>...v.v>v.>v..>.>.....v.>v.>...v>>v...v......>vv.v.>>.v..>>.>.>>.>>v......>......>v>>v>>>>..>.v>vvv>.......>.v.>vvv..>v...>>>..v>vv.>.
v>v......>...>.>.vv>v.>>.v>....>>...>v>...>...>v.>....v>.>..>>.vvv.>.>v>>.>...v.>v>vvv>.>vv..>..v.>.v.....>v.vvv.>v....>>vv.>.....>>v.>>...
.>.>>....>vv>.>>v.vv.>..v>>...v>v..vv..>.v....>>v..>.>...>>..>vv.v.>v..v...v>.v>v.>..vv...v.v>..v.>v.>v>..>>>...>>.>>>.vv..v>v.v>..>v>>v>v>
.>.vv>.>vvvv.....>>>.vv.v.v..v>>...>..v>>>>>>...v>>>..vvv..v.>.v.>>.>v..>>...vvv.>>>..>>vv.v.>.>..v>.v>.>..v........>..v...vvv..>.>..>vv...
.v>.vv>>.vv......v.vv...v>.>vv..vv...v...v...>.>.>>vv.>...>>vv>..v>...>....vv..v..vv>v...v.>>.v>v>..v.>v.>v>>..>.v>>.v...v>..v>v..v......v.
v..>>.>vvv..>v>>>..v....>.vv.>>>>v.>.v.v.vv..v>>vvv..>>>>>.........v...vv.v...>.>.v>v>..>>>.v.v>>>.vv>.v.vv.>vv.>.>vv>>vvv....v.>..v>>....v
v....>.>......>>>.>.....v.v.>..........v>.v..>.....v.>v..vv>>.>v..>v>.....v.v>v.v>>>.>...>>>...v.....v..v>v>..>>v..v>v>.v.v...v>....v>..vv.
.>.vv>.>.vvv.>.>.>....v.>.>v>.......>v.>.v>v>>.>>.>v..>.v...v.v.>.>v.>...>>v>v>..v...>..v>...>.v>v.v>>...v>.>>.v.v>..>v...>>>...v.>.>>>....
v>...v>..>v>>v.>v....v>.vv...>>.....>.v..>.>>....>v.>..v>v>.>>.....>>....>.>.>.v>.v.vv>...v.vv>>>>vv...vv>vv>.v..>>..>>>..v.>.>>>.>..v>v>>>
>..>>>>..>>.>...v.>>.>v..v...>v.>>v.>.v.>v>.vvvvvv>v>......vv.>vv...>vv..>v>>>v.v..v..v.v>>v..v..>>.vv>..>v...>.v.v.>>v.>....>....v>.>>>.>.
>v.>v......>.vv.vv>>v>.>.....v>.>.v..v...v.v..v>..v..>>>>...v.v....v...>.....v>.v.>.....vv>.v...>vv.>..>>.vv>..>...v..>.>>>..v....>>>>v>.v.
..v>..v..>vv..>>vvv>vv....>..v.v>>vv..>v..v.v.v>>>v.>>.vv>vvv..>v...>>.>..>v....v.v..vvv.>..>.v..>.v....>>...vv.vvv.>.>>.>v.>v>v..>.>>...v>
..v>.>v.>.vvv.>v..vv>vv..>..>v.>v.vv>>..v...>.>...v.>.>..>...>v>.>..>.>.>>>>>>.v.v..........vv...v>.v>>....v..>>>.vvv..>v.v.>>.v.v>.v...v.>
>v>.>>..v>>..>>...>v.v....>>....v.>>>vvv>..>..v>v.>v.v..>.v.........>..vvv.vv.v..v>.>vv>..v..v>.v..>>..v.>..>....v..v..>>vv.v.v>>>.vv>vv.>v
vv.>.v..>>>.>vvvv>v..v...v>.v..v.v>>vv>>...>>.v.>>>>vv.>v>vv>>.v.v.v>>....>...v..v..>vv>v..v>>v.>>>v>.....v.v.vv>vv.>v.v.v..>>..v>>v>v.>...
..>>...v...v>>..>...>v>...>.v..v.>.vv.....vv.>..>v>..vv.v>......v>...>>>..>.>...v...>v.>v.v..>>...v....vv>..>>...>.v>.>.v>..v..>>>vv>>..>.>
>.....v...v>v>.v.>..vv......v>.v>>>v..........>.v>vv>v..v.>v.vvv>>>...v>v>>.>..vvv.>....>...>v..>.>.v.v..>.v.>.........vv.v>>..vv...v...v.v
v..>.>v.>..vvv.>.>>....>>v.v..vv.vv.v..vv..v......>...>.>>v>v>..vv>...vv.v.>>.>.>....v.>..v.v.v>....>>..>>>..>.v.>.v>vv..>>v...>.v...>v....
vv.>..v>>..vv>.vv.>.>.>.vv.....v.>v.....v>>....>v.>v.v.....v>vv.v....vv..>>>..v>.v...>......>v>.v.v.>>.>..>>v....v>>>>.>>.>v........>.>.vv.
..>.>>.....>>.vv>>>vv.>..vv>..v..>..vv.>>....vv.v>>>..vvvv.>.>.>..v>vvv..v>.v......>.>v...v>>.vv.v>....v..>>>v.vv.vv..v.vv....vv..vv>..vv.>
.vv.vv>.>.>v.>.>..vv.vv>.v.....>.>>.vv.>vv.>.vv>>.>>.>>>>.>...v.>.v>>.vv.....>.>..vv>v>..>v..>.>v..>vvv.>vv.>.v>vv>>...>v..v>..>v.>......v.
v..>v......v..>>.v>.vvv......v>..>v..>.>..>..>.vv.....v...>>..v>vv.>>>v.>.v>..>...v>v.........>>.v.vv>vv..v..v.v>>.>v..>..>v>.>v>....v.>.vv
..>>>>>..v>>v>..vvv..>vv.vv..>...v.....v........vv.v>.>.>...vv>v>.>..>.v.vvv>.>v.>>......v>v.....>....>..>v..>.v....>.v..>..>>.v..v...>>.>.
v.v>.>...vv>..v....v..vv>........>v.......vv>....>...vv>.>..>v.vv...v>>.>>vvvvvvv.>v>v..v..>.>.>...>v..>>>v>v.>..>v..>v...v....v>>>.>....v.
>>...>...v.v..v.v.v....v..vvv>..>.>v.vv>.vvv..v>.>v..v...>v.>..>v>v....>v..>..v..>>>>.>v.v.v.....>v..v.v>v..>.>...>...vvv.v>v>>.v>.vvv.>..>
..v>.v.v.v>v>>v.>.....v>>v..v>..>>>>..v..>.vv>.v.>.v>v>..v>...v>.>.v>vv.vv...>>...vv...v..v.>>.>..v>.>vvv>......>.>v>..v......>.v..vvv>.>v>
vvv.v..v.vv.vv>...v>v>..>.v..>v.>.>>.>....v>v..v.>....v>.v....vv>vv..v.>v>...>>>>>v>>v.......v>>v.>v...>>.>v...vv.>.>vv..>..>>.>.v>v.v.v.>.
>>>.v>>>...>.>.v..v..v..v>v>.v..>>v>..>>v>>vv..v.>..v>.>>....>vv>.>v....v>v>vv...v....>>.>.vv..v>v..v>.>..>>.v..>v.>v...>>>v....>>>>>....vv
v>>.v.v..>v..v>>v......v>>>.v.v>.vv....>v>..>>>v>>..>..>>..v.>..v.>>v..>>>.>vvv.>v..vv...vv..>..>v..v.>.v..>.v>vv....>>>v.....>.>v..>.>.v.>
..v.v>...v>...vv.>..v......v>.v>..>>.>>v.>..>...v.>.v..>>...v.>.v>.>..>>v>v........v..>v.>v.>..v>.>>....>..>>..vvv>vv...vv..>.>>....>.>..vv
v>.v.>vvvv.v>.>v>>.>v..v.v...v..v.v>....v>.>.>>.>.v..v.vv.v>...>....>v..vv.v>v.>v.>>.>v>.>>vv>.v...v..v.v>.>v...v.>v.vv..>>>......v.v>.v.v.
>v.>.>...>v.v...v>>..>..>...v>>>>v>.>>..vvvv...v>.v...v..vv.v.....>vv.v.>v...v.v..v.>vv>.v>........>>.v>v>.>>.v>>>.vv..>vv..>>........v.>>>
>>...vvv....>>.>>>..>.....vv.v...v........>v>>.>vv..>.v.>.>...v...v....>v....>.>>>..vv..v..>v>v>.....vv...>.>...>>.v.>>.v........v>...>..v.
>.>.v.>>>v>.......vv>...>...>.>.v...v.vv>>.vv>..>..>v..vv>.v.v>vv.v..>>v.>.v.....v..v.v....>v.>v>v.v>v..>.v.>>vvv>v>.v...v>..>v...>v>.>...>
v..v..>.v..>.>v.v>.>vv.v.v>>.v..v>..>v>v..>..>>>....>vvv>.>>.v.v..v.>..v.......v..v.vvv..>v....>......>>..>..v>>>.>v>v>..v....>>..v.vv....>
.v.>.>v>.vv>v...v...vv..v.v....>...>.v>..>.v>.>...>.v.v...>.>.vv.>.....v.v.>vvv>>>v.....v.>.....>>...>.vvv...v>..>v>v.>>.vv>>....>..vv..v..
>>>....>.v>>>>.vv>.>v>>v>>..>>....>v.>...v.vvv.v>v..v>>v...vv>.>>v....>v.vv.v.....>v>>.v....v>>..>..>..>v.vv.vv....>...v>>>>..>>vv..v>.>v>.
>.>..v...>...>.>v...v....v..v..v.>vv>.>.>.>v.v>vv.>v>v..>..>>>.v.>....v>>v.....v....>....v....>.>..vv.v.vv.>.v.>vv.>>>.vv>>.vv>v..>v.....v.
>>.>.v.....>>.>>...>..>..>..>v>...>>>v>>>.v..>>>...vv...v.vv...>>.v.v.......>vvv>..>.>..>.>.v>vv...>.v>..>>.v.>v.v.>>>.vv..>v..v..>.>>..>v.
...v.>v.v......vv...v..>...v.v>v>>...>>.vv.>.....>...>.vv>.>...>>>.v.>v.>.>.>>...>.v..v.v>v.>..>...>v.vv.v...>.>>......v>..>>.v.v>>.....>v.
.>.vv..vvv.v.v...>.>.vvv...v>..>.>>.v..v...>..>.v..v.>.>>..>v..v.>v..>...>v>.>..v>vvv..>>v>v...>>.>v>.....>...v..>..v.>v>.>..v.>v....>....>
>..v>...vv>..v.v>>>..>...v.>.>..>>>v..v>.>vvv..v>..vv..v..>>>..>..v......v>v.vvvv>..>..>>.v>>vvv.v.>....>...v>>>vvv.vvv.vv>>.>vv....>.v...v
.>...>.>v>..>.v>..>vvv..v>>.v.>>v...>.vv.v....>v>vv>..>>..v.v.vv>v>>v.>.v..v.>.>v.....>..vv.vv.>v.v.vvv...v....v.....v..>>...vvvvvvvv>>.>>.
.....v>>..v.vv>v>v..>v>..>....v..v....v..v...vv...>>v>>.>v>.>>>v.v..>>.>>...>>.v>vv.>v..>vv.v>>....v>>.>..v...>v>..vv>..v..>...v.>vvv...v>>
>.vv>>v>>>...v.v........v>vv..v>..v..>....v.>vvv.v.vvv.>>.>>>..v.>>.vv.>>v.>..v>v.v.........>>>vvv>>.vvvv.......v..vv...>...v..>v>>......>.
......>>>.....>>.>>..vv>.>..vvvv.v>>.v...v>...>.>.v..v...v.v...v....v>>>v..>>.v>v.....vvv>vvvv.v......v...>.v.vv>v>>>>v>...>v>.vvvv>..v.v>.
>>.>v..v>..>.....v.v..>....>>.v...v>...>.v>v>v.>..>v.vv.>>.>...v..v..>v.v.vvvv>.vv..v..v.>....vv.>..>.vvv>.>v......v.>vv>..>>vv.>v.>vv..v>>
>..>.>.>vv.vv.>v.vvv.vv.>v....>>..>>..v.>>.>vv.....vv..v..vv..>v.>..>..v>v.....>v...v.>.......v>.>...>.>vv>.vv>vv..v>...v>vv.v>>vv..v.>v>>v
....>>.v..>.v...>.v.>>.v.v.>>v...v.v.v>>...v.>..v.v...>>.....>.v..vv>>.>.>.>v.v>v...>..v>..v.v>vv...>v>..>..v....v.v....>v.>v.......>..>..>
..>.v>>..>.>>.....>v>..>>..v....v>v.>v>v>..>.v.v...v.v>>v>>>>..v..>..>>vv....v..v.>..>vvv>>>..v.vv>v..v..v.>v>.>.>>.>.....v...>v....vv.>..v
v..>..>....v>......>v.vvv>vvvv...v...>...v>..v..v>...vv.>>..>.>.>.vvv.>.....>...v>>.>vv.>>....>.v....v.v>>.v>...v>.v..v.>..v.v.>.>.>.v>.v..
>>>......>..>.....>>..v.v>....v>v.v...>v..v.v....>.>.vv>.>..v.>.v.vv....>...v.>.v.v..>.v>.>.>.>v>>>>>>>..vv.>v.v.>.v..v.vv..>.v.v>vv..v>..>
v..>.v......vvvv....v..vv...v..v...>....vv.>v>.>..v..v.>>.>v>v..>v..v.vv.v.v>.>.....>vvv.v>>..vv>.>.v.....>>>vv..>>>..>v.>.v.>v.>vv.>.>.>v.
.v>vvv.>.vv.v>vv.>v.>.>v>.>.vv..>.v.....v.v.v>>v>v.>...v.>..v...v.vvv..vv..>>v.vv.>.....v>>vv.>..>..v.vv..v..v>vv.v.v.v>>..>>..>>...vv>...>
..>....>.v.v.v.v.>>........v>.v>vvv.v.>..v.>...v.v..v>v.v>v...v>>v>>.>vv....>vv.vv.....v>>>v...>..v....v..>.v>>v...vv..>>..>.v..v>...>....>
..vvv.>.v>>v.>..v....vv..vvvv.v.>>.....v.>v>v.v.vv>>.v.....>.v>>v.v.v.v....v..v......v>v>.>vvv..v>>...v.....v>..>.vv>>>..v.>.v...>>.......v
>.v.v>.>v>.>.v..v..v..>vv...v>.vv..>.>v.>vv.v.>....v.v..>v..>v.v>....>.v>.v.>>..>v.>.v..v.v>...>v...>v>...>>.....v.>.>>>vv>v>.v>>vv.v.>..>.
v...>vv>>...>v.>.>.>vv>..v>v.>..v..>>....>>.v>>v...v..>>.v.>..v.v.v.v..v.v>v....>.v>.vv..>>v>v.v>>..>v>v>v...>vv.v...v...v>..>>>.v.......v.`;

const testInput = `v...>>.vv>
.vv>>.vv..
>>.>v>...v
>>v>>.>.v.
v>v.vv.v..
>.>>..v...
.vv..>.>v.
v.v..>>v.v
....v..v.>`;

const data = input.split('\n')
  .map(line => {
    return line.split('');
  });

const graph = {};
const eastHerd = {};
const southHerd = {};

const maxX = data[0].length;
const maxY = data.length;
let id = 1;

for (let y = 0; y < maxY; y++) {
  graph[y] = {};

  for (let x = 0; x < maxX; x++) {
    const val = data[y][x];

    graph[y][x] = {
      id,
      val: val,
      xInc: (val === '>') ? 1 : 0,
      yInc: (val === 'v') ? 1 : 0,
      x: x,
      y: y
    };

    if (val === 'v' ) {
      southHerd[id] = graph[y][x];
    } else if (val === '>') {
      eastHerd[id] = graph[y][x];
    }
    id++;
  }
}

// console.log(nodes);

function swapNode(a, b) {
  const oldX = a.x;
  const oldY = a.y;

  a.y = b.y;
  a.x = b.x;

  b.y = oldY;
  b.x = oldX;

  graph[a.y][a.x] = a;
  graph[b.y][b.x] = b;
}

function takeStep() {
  let newNodes = [];
  let nodesMoved = 0;

  Object.keys(eastHerd).forEach((id) => {
    const node = eastHerd[id];

    const newX = (node.x + 1) % maxX;
    if (graph[node.y][newX].val === '.') {
      const newNode = _.clone(node);
      newNode.x = newX;
      newNodes.push(newNode);
      nodesMoved++;
    }
  })
  newNodes.forEach(node => swapNode(eastHerd[node.id], graph[node.y][node.x]));

  newNodes = [];
  Object.keys(southHerd).forEach((id) => {
    const node = southHerd[id];

    const newY = (node.y + 1) % maxY;
    if (graph[newY][node.x].val === '.') {
      const newNode = _.clone(node);
      newNode.y = newY;
      newNodes.push(newNode);
      nodesMoved++;
    }
  });

  newNodes.forEach(node => swapNode(southHerd[node.id], graph[node.y][node.x]));

  return nodesMoved;
}

function printGraph() {
  for (let y = 0; y < maxY; y++) {
    let str = '';
    for (let x = 0; x < maxX; x++) {
      str += graph[y][x].val;
    }
    console.log(str);
  }
  console.log('-------------')
}
// printGraph();

let nodesMoved;
let turns = 0;
do {
  turns++;
  nodesMoved = takeStep();

  // printGraph();?
  // nodesMoved = 0;
} while (nodesMoved > 0);


console.log(turns);
